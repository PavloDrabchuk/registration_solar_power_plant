<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script>
        function loadUserList() {
            var s=document.getElementById("types");
            var selectedOption=s.options[s.selectedIndex].value;
            console.log("user list: "+selectedOption);
            if(selectedOption==="FOR_USER"){
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("userSelect").innerHTML =
                        this.responseText;
                }
            };

            xhttp.open("GET", "getUsersList", true);
            xhttp.send();}
            else {
                var element = document.getElementById("userSelect");
                while (element.firstChild) {
                    element.removeChild(element.firstChild);
                }
            }
        }
    </script>
</head>
<body>

<h2>new message</h2>

<form method="post" th:action="@{/messages}" th:object="${message}">
    <label for="title">Title:
        <input id="title" type="text" th:field="*{title}">
    </label>
    <label for="text">Text:
        <input id="text" type="text" th:field="*{text}">
    </label>

    <label for="typesForUser" th:if="${editorAccess==null}">
        <select name="type" id="typesForUser">
            <option name="FOR_EDITOR" value="FOR_EDITOR">Питання</option>
            <option name="FOR_ADMIN" value="FOR_ADMIN">Технічна помилка</option>
<!--            <option name="user" value="user">For user (?)</option>-->
        </select>
    </label>

    <label for="types" th:if="${editorAccess}">
        <select name="type" id="types" onclick="loadUserList()">
            <option name="INFORMATION" value="INFORMATION">Info</option>
            <option name="UPDATE" value="UPDATE">Update</option>
            <option name="FOR_USER" value="FOR_USER" >For user (?)</option>
        </select>
    </label>

    <div id="userSelect" th:if="${editorAccess}">

    </div>

    <input type="submit" value="Sent message">
</form>


</body>
</html>